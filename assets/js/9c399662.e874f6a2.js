"use strict";(self.webpackChunkminetrax_github_io=self.webpackChunkminetrax_github_io||[]).push([[8022],{189:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"web/discord-integration","title":"Discord Integration","description":"Currently MineTrax has these integration with Discord:","source":"@site/docs/web/discord-integration-feature.md","sourceDirName":"web","slug":"/web/discord-integration","permalink":"/docs/web/discord-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/minetrax/minetrax.github.io/edit/main/docs/web/discord-integration-feature.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"title":"Discord Integration","id":"discord-integration"},"sidebar":"tutorialSidebar","previous":{"title":"How to Debug","permalink":"/docs/web/debug"},"next":{"title":"Localization","permalink":"/docs/web/localization"}}');var o=i(4848),r=i(8453);const s={sidebar_position:5,title:"Discord Integration",id:"discord-integration"},d=void 0,c={},l=[{value:"Setup Discord OAuth and Bot for Notifications",id:"setup-discord-oauth-and-bot-for-notifications",level:2},{value:"1. Create application in Discord for OAuth and Bot.",id:"1-create-application-in-discord-for-oauth-and-bot",level:3},{value:"2. Add Bot to your server",id:"2-add-bot-to-your-server",level:3},{value:"Discord Server Auto-Join Feature",id:"discord-server-auto-join-feature",level:2}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Currently MineTrax has these integration with Discord:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Social Authentication (OAuth)"}),"\n",(0,o.jsx)(n.li,{children:"Discord Notifications (with Bot)"}),"\n",(0,o.jsx)(n.li,{children:"Discord Server Auto-Join when user login with Discord."}),"\n",(0,o.jsx)(n.li,{children:"Serverlog (Webhook)"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Future planned integrations:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Role Sync with Linked Roles feature"}),"\n",(0,o.jsx)(n.li,{children:"Interactions with Bot"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"setup-discord-oauth-and-bot-for-notifications",children:"Setup Discord OAuth and Bot for Notifications"}),"\n",(0,o.jsx)(n.h3,{id:"1-create-application-in-discord-for-oauth-and-bot",children:"1. Create application in Discord for OAuth and Bot."}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Go to ",(0,o.jsx)(n.a,{href:"https://discord.com/developers/applications",children:"Discord Developers Portal"})," and create a new application by clicking on ",(0,o.jsx)(n.code,{children:"New Application"})," button at top right. You can name it anything you like."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Now go to ",(0,o.jsx)(n.code,{children:"OAuth2"})," tab and note down ",(0,o.jsx)(n.code,{children:"CLIENT ID"})," and ",(0,o.jsx)(n.code,{children:"CLIENT SECRET"})," from there. You will have to ",(0,o.jsx)(n.code,{children:"Reset Secret"})," once to view it."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["You now need to add a Redirect URL, Use the ",(0,o.jsx)(n.code,{children:"Add Redirect"})," button to do this. Your URL will be your base domain with ",(0,o.jsx)(n.code,{children:"/auth/discord/callback"})," added onto the end. For example for base ",(0,o.jsx)(n.code,{children:"https://minetrax.world"})," our callback becomes ",(0,o.jsx)(n.code,{children:"https://minetrax.world/auth/discord/callback"}),". Enter the callback there and click ",(0,o.jsx)(n.code,{children:"Save Changes"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Next go to ",(0,o.jsx)(n.code,{children:"Bot"})," tab, and find your ",(0,o.jsx)(n.code,{children:"TOKEN"})," (You will have to ",(0,o.jsx)(n.code,{children:"Reset Token"})," once to view it). Copy and note down the that bot token we will need it in next steps."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Now open your ",(0,o.jsx)(n.code,{children:".env"})," file in minetrax directory and update these variables as follow."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",metastring:'title=".env"',children:'DISCORD_OAUTH_ENABLED=true #Set it to `true` if `false`\nDISCORD_CLIENT_ID= #Enter your CLIENT ID here\nDISCORD_CLIENT_SECRET= #Enter your CLIENT SECRET here\nDISCORD_REDIRECT_URI="${APP_URL}/auth/discord/callback" #Leave it as it is.\nDISCORD_BOT_TOKEN= #Enter your Bot Token here\n'})}),"\n",(0,o.jsx)(n.p,{children:"Example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",metastring:'title".env"',children:'DISCORD_OAUTH_ENABLED=true\nDISCORD_CLIENT_ID=865111111111111111\nDISCORD_CLIENT_SECRET=Qfsdalf_45-b222-o0E_aAMklasdjf\nDISCORD_REDIRECT_URI="${APP_URL}/auth/discord/callback"\nDISCORD_BOT_TOKEN=ODY1NzQ2OTMyMdkaslfjsdfl.Gn7gAZ.3954sdalfasdflh0945353409\n'})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Run update ",(0,o.jsx)(n.code,{children:"sh update.sh"})," so that the changes get reflected in the application."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd /var/www/minetrax\nsh update.sh\n"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"2-add-bot-to-your-server",children:"2. Add Bot to your server"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Open your minetrax directory in SSH and run ",(0,o.jsx)(n.code,{children:"php artisan discord:setup"})," to initialize the process."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd /var/www/minetrax\nphp artisan discord:setup\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["It will ask if the bot is already added to your server. Type ",(0,o.jsx)(n.code,{children:"no"})," and enter."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Next it will ask you for CLIENT ID. Enter the CLIENT ID which you entered in ",(0,o.jsx)(n.code,{children:".env"}),", and then press Enter."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"It will give you a link which you should click and follow the instructions to add the Bot to your Discord Server."}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Once its added come back to the prompt and type ",(0,o.jsx)(n.code,{children:"yes"})," and press Enter."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["It will do few checks and everything should complete and you should see a message ",(0,o.jsx)(n.code,{children:"Your bot has been identified by Discord and can now send API requests!"}),"."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Done."}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.admonition,{title:"User need to login with Discord once",type:"info",children:[(0,o.jsx)(n.p,{children:"For notification to work for a user, they will need to login with Discord at least once after you have setup the Discord OAuth and Bot."}),(0,o.jsx)(n.p,{children:"Next time whenever your user login with Discord, it will automatically link their account with Discord and do everything require to send notifications to him in DM."})]}),"\n",(0,o.jsx)(n.h2,{id:"discord-server-auto-join-feature",children:"Discord Server Auto-Join Feature"}),"\n",(0,o.jsx)(n.p,{children:"You can auto-join your users to a specific Discord Server when they login with Discord."}),"\n",(0,o.jsx)(n.p,{children:"For this feature to work, you need to follow these steps:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Make sure you follow the ",(0,o.jsx)(n.a,{href:"#setup-discord-oauth-and-bot-for-notifications",children:"Setup Discord OAuth and Bot for Notifications"})," guide to setup your bot and Discord OAuth is enabled."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Make sure your bot has the following additional permissions: (if not, go to Discord Developers Portal and add it)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"CREATE_INSTANT_INVITE"})}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Open ",(0,o.jsx)(n.code,{children:"Admin > Settings > General"})," and fill your Discord Server ID in ",(0,o.jsx)(n.code,{children:"Discord Server ID"})," field and save it."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Open ",(0,o.jsx)(n.code,{children:".env"})," file in your minetrax directory and update the following variables:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-php",metastring:'title=".env"',children:"DISCORD_FORCE_JOIN_SERVER=true\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Run update ",(0,o.jsx)(n.code,{children:"sh update.sh"})," so that the changes get reflected in the application."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cd /var/www/minetrax\nsh update.sh\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Now whenever your user login with Discord, they will be auto-joined to the Discord Server."}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>d});var t=i(6540);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);